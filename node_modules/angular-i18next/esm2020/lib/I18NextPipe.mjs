import { Inject, Injectable, Pipe } from '@angular/core';
import { I18NEXT_NAMESPACE, I18NEXT_SCOPE, I18NEXT_SERVICE, } from './I18NEXT_TOKENS';
import * as i0 from "@angular/core";
export class I18NextPipe {
    constructor(translateI18Next, ns, scope) {
        this.translateI18Next = translateI18Next;
        this.ns = ns;
        this.scope = scope;
    }
    transform(key, options) {
        options = this.prepareOptions(options);
        let i18nOpts = this.translateI18Next.options;
        if (options.prependScope === undefined || options.prependScope === true) {
            if (this.scope) {
                key = this.prependScope(key, this.scope, i18nOpts.keySeparator, i18nOpts.nsSeparator);
            }
        }
        if (options.prependNamespace === undefined ||
            options.prependNamespace === true) {
            if (this.ns) {
                key = this.prependNamespace(key, this.ns, i18nOpts.nsSeparator);
            }
        }
        let result = this.translateI18Next.t(key, options);
        if (options.format) {
            if (result) {
                result = this.translateI18Next.format(result, options.format, this.translateI18Next.language);
            }
        }
        return result;
    }
    prependScope(key, scope, keySeparator, nsSeparator) {
        const nsSep = nsSeparator || '';
        const keySep = keySeparator || '';
        if (typeof key === 'string') {
            key = [key];
        }
        if (typeof scope === 'string') {
            scope = [scope];
        }
        let keysWithScope = [];
        for (let i = 0; i < key.length; i++) {
            const k = key[i];
            if (!this.keyContainsNsSeparator(k, nsSep)) {
                // Do not set scope, if key contains a namespace
                keysWithScope.push(...scope.map((sc) => this.joinStrings(keySep, sc, k)));
            }
            keysWithScope.push(k);
        }
        return keysWithScope;
    }
    prependNamespace(key, ns, nsSeparator) {
        const nsSep = nsSeparator || '';
        if (typeof key === 'string') {
            key = [key];
        }
        if (typeof ns === 'string') {
            ns = [ns];
        }
        let keysWithNamespace = [];
        for (let i = 0; i < key.length; i++) {
            const k = key[i];
            if (!this.keyContainsNsSeparator(k, nsSep)) {
                // Do not set namespace, if key contains a namespace
                keysWithNamespace.push(...ns.map((n) => this.joinStrings(nsSep, n, k)));
            }
            keysWithNamespace.push(k);
        }
        return keysWithNamespace;
    }
    joinStrings(separator, ...str) {
        return [...str].join(separator);
    }
    keyContainsNsSeparator(key, nsSeparator) {
        return key.indexOf(nsSeparator) !== -1;
    }
    prepareOptions(options) {
        options = options || {};
        if (options.context != null)
            options.context = options.context.toString();
        return options;
    }
}
I18NextPipe.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.10", ngImport: i0, type: I18NextPipe, deps: [{ token: I18NEXT_SERVICE }, { token: I18NEXT_NAMESPACE }, { token: I18NEXT_SCOPE }], target: i0.ɵɵFactoryTarget.Pipe });
I18NextPipe.ɵpipe = i0.ɵɵngDeclarePipe({ minVersion: "14.0.0", version: "14.2.10", ngImport: i0, type: I18NextPipe, name: "i18next" });
I18NextPipe.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "14.2.10", ngImport: i0, type: I18NextPipe });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.10", ngImport: i0, type: I18NextPipe, decorators: [{
            type: Injectable
        }, {
            type: Pipe,
            args: [{
                    name: 'i18next',
                }]
        }], ctorParameters: function () { return [{ type: undefined, decorators: [{
                    type: Inject,
                    args: [I18NEXT_SERVICE]
                }] }, { type: undefined, decorators: [{
                    type: Inject,
                    args: [I18NEXT_NAMESPACE]
                }] }, { type: undefined, decorators: [{
                    type: Inject,
                    args: [I18NEXT_SCOPE]
                }] }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSTE4TmV4dFBpcGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvbGliL0kxOE5leHRQaXBlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLElBQUksRUFBaUIsTUFBTSxlQUFlLENBQUM7QUFHeEUsT0FBTyxFQUNMLGlCQUFpQixFQUNqQixhQUFhLEVBQ2IsZUFBZSxHQUNoQixNQUFNLGtCQUFrQixDQUFDOztBQU8xQixNQUFNLE9BQU8sV0FBVztJQUN0QixZQUNxQyxnQkFBcUMsRUFDbkMsRUFBcUIsRUFDekIsS0FBd0I7UUFGdEIscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFxQjtRQUNuQyxPQUFFLEdBQUYsRUFBRSxDQUFtQjtRQUN6QixVQUFLLEdBQUwsS0FBSyxDQUFtQjtJQUN4RCxDQUFDO0lBRUcsU0FBUyxDQUFDLEdBQXNCLEVBQUUsT0FBcUI7UUFDNUQsT0FBTyxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7UUFFdkMsSUFBSSxRQUFRLEdBQXFCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUM7UUFDL0QsSUFBSSxPQUFPLENBQUMsWUFBWSxLQUFLLFNBQVMsSUFBSSxPQUFPLENBQUMsWUFBWSxLQUFLLElBQUksRUFBRTtZQUN2RSxJQUFJLElBQUksQ0FBQyxLQUFLLEVBQUU7Z0JBQ2QsR0FBRyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQ3JCLEdBQUcsRUFDSCxJQUFJLENBQUMsS0FBSyxFQUNWLFFBQVEsQ0FBQyxZQUFZLEVBQ3JCLFFBQVEsQ0FBQyxXQUFXLENBQ3JCLENBQUM7YUFDSDtTQUNGO1FBQ0QsSUFDRSxPQUFPLENBQUMsZ0JBQWdCLEtBQUssU0FBUztZQUN0QyxPQUFPLENBQUMsZ0JBQWdCLEtBQUssSUFBSSxFQUNqQztZQUNBLElBQUksSUFBSSxDQUFDLEVBQUUsRUFBRTtnQkFDWCxHQUFHLEdBQUcsSUFB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QjtRQUNELE9BQU8saUJBQWlCLENBQUM7SUFDM0IsQ0FBQztJQUVPLFdBQVcsQ0FBQyxTQUFpQixFQUFFLEdBQUcsR0FBYTtRQUNyRCxPQUFPLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDbEMsQ0FBQztJQUVPLHNCQUFzQixDQUFDLEdBQVcsRUFBRSxXQUFtQjtRQUM3RCxPQUFPLEdBQUcsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDekMsQ0FBQztJQUVPLGNBQWMsQ0FBQyxPQUFxQjtRQUMxQyxPQUFPLEdBQUcsT0FBTyxJQUFJLEVBQUUsQ0FBQztRQUN4QixJQUFJLE9BQU8sQ0FBQyxPQUFPLElBQUksSUFBSTtZQUFFLE9BQU8sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUMxRSxPQUFPLE9BQU8sQ0FBQztJQUNqQixDQUFDOzt5R0E1R1UsV0FBVyxrQkFFWixlQUFlLGFBQ2YsaUJBQWlCLGFBQ2pCLGFBQWE7dUdBSlosV0FBVzs2R0FBWCxXQUFXOzRGQUFYLFdBQVc7a0JBSnZCLFVBQVU7O2tCQUNWLElBQUk7bUJBQUM7b0JBQ0osSUFBSSxFQUFFLFNBQVM7aUJBQ2hCOzswQkFHSSxNQUFNOzJCQUFDLGVBQWU7OzBCQUN0QixNQUFNOzJCQUFDLGlCQUFpQjs7MEJBQ3hCLE1BQU07MkJBQUMsYUFBYSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdCwgSW5qZWN0YWJsZSwgUGlwZSwgUGlwZVRyYW5zZm9ybSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgKiBhcyBpMThuIGZyb20gJ2kxOG5leHQnO1xyXG5cclxuaW1wb3J0IHtcclxuICBJMThORVhUX05BTUVTUEFDRSxcclxuICBJMThORVhUX1NDT1BFLFxyXG4gIEkxOE5FWFRfU0VSVklDRSxcclxufSBmcm9tICcuL0kxOE5FWFRfVE9LRU5TJztcclxuaW1wb3J0IHsgSVRyYW5zbGF0aW9uU2VydmljZSB9IGZyb20gJy4vSVRyYW5zbGF0aW9uU2VydmljZSc7XHJcbmltcG9ydCB7IFBpcGVPcHRpb25zIH0gZnJvbSAnLi9tb2RlbHMnO1xyXG5ASW5qZWN0YWJsZSgpXHJcbkBQaXBlKHtcclxuICBuYW1lOiAnaTE4bmV4dCcsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBJMThOZXh0UGlwZSBpbXBsZW1lbnRzIFBpcGVUcmFuc2Zvcm0ge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgQEluamVjdChJMThORVhUX1NFUlZJQ0UpIHByb3RlY3RlZCB0cmFuc2xhdGVJMThOZXh0OiBJVHJhbnNsYXRpb25TZXJ2aWNlLFxyXG4gICAgQEluamVjdChJMThORVhUX05BTUVTUEFDRSkgcHJvdGVjdGVkIG5zOiBzdHJpbmcgfCBzdHJpbmdbXSxcclxuICAgIEBJbmplY3QoSTE4TkVYVF9TQ09QRSkgcHJvdGVjdGVkIHNjb3BlOiBzdHJpbmcgfCBzdHJpbmdbXVxyXG4gICkge31cclxuXHJcbiAgcHVibGljIHRyYW5zZm9ybShrZXk6IHN0cmluZyB8IHN0cmluZ1tdLCBvcHRpb25zPzogUGlwZU9wdGlvbnMpOiBzdHJpbmcge1xyXG4gICAgb3B0aW9ucyA9IHRoaXMucHJlcGFyZU9wdGlvbnMob3B0aW9ucyk7XHJcblxyXG4gICAgbGV0IGkxOG5PcHRzOiBpMThuLkluaXRPcHRpb25zID0gdGhpcy50cmFuc2xhdGVJMThOZXh0Lm9wdGlvbnM7XHJcbiAgICBpZiAob3B0aW9ucy5wcmVwZW5kU2NvcGUgPT09IHVuZGVmaW5lZCB8fCBvcHRpb25zLnByZXBlbmRTY29wZSA9PT0gdHJ1ZSkge1xyXG4gICAgICBpZiAodGhpcy5zY29wZSkge1xyXG4gICAgICAgIGtleSA9IHRoaXMucHJlcGVuZFNjb3BlKFxyXG4gICAgICAgICAga2V5LFxyXG4gICAgICAgICAgdGhpcy5zY29wZSxcclxuICAgICAgICAgIGkxOG5PcHRzLmtleVNlcGFyYXRvcixcclxuICAgICAgICAgIGkxOG5PcHRzLm5zU2VwYXJhdG9yXHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKFxyXG4gICAgICBvcHRpb25zLnByZXBlbmROYW1lc3BhY2UgPT09IHVuZGVmaW5lZCB8fFxyXG4gICAgICBvcHRpb25zLnByZXBlbmROYW1lc3BhY2UgPT09IHRydWVcclxuICAgICkge1xyXG4gICAgICBpZiAodGhpcy5ucykge1xyXG4gICAgICAgIGtleSA9IHRoaXMucHJlcGVuZE5hbWVzcGFjZShrZXksIHRoaXMubnMsIGkxOG5PcHRzLm5zU2VwYXJhdG9yKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGxldCByZXN1bHQ6IHN0cmluZyA9IHRoaXMudHJhbnNsYXRlSTE4TmV4dC50KGtleSwgb3B0aW9ucyk7XHJcblxyXG4gICAgaWYgKG9wdGlvbnMuZm9ybWF0KSB7XHJcbiAgICAgIGlmIChyZXN1bHQpIHtcclxuICAgICAgICByZXN1bHQgPSB0aGlzLnRyYW5zbGF0ZUkxOE5leHQuZm9ybWF0KFxyXG4gICAgICAgICAgcmVzdWx0LFxyXG4gICAgICAgICAgb3B0aW9ucy5mb3JtYXQsXHJcbiAgICAgICAgICB0aGlzLnRyYW5zbGF0ZUkxOE5leHQubGFuZ3VhZ2VcclxuICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBwcmVwZW5kU2NvcGUoXHJcbiAgICBrZXk6IHN0cmluZyB8IHN0cmluZ1tdLFxyXG4gICAgc2NvcGU6IHN0cmluZyB8IHN0cmluZ1tdLFxyXG4gICAga2V5U2VwYXJhdG9yOiBzdHJpbmcgfCBmYWxzZSB8IHVuZGVmaW5lZCxcclxuICAgIG5zU2VwYXJhdG9yOiBzdHJpbmcgfCBmYWxzZSB8IHVuZGVmaW5lZFxyXG4gICk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IG5zU2VwID0gbnNTZXBhcmF0b3IgfHwgJyc7XHJcbiAgICBjb25zdCBrZXlTZXAgPSBrZXlTZXBhcmF0b3IgfHwgJyc7XHJcbiAgICBpZiAodHlwZW9mIGtleSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAga2V5ID0gW2tleV07XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIHNjb3BlID09PSAnc3RyaW5nJykge1xyXG4gICAgICBzY29wZSA9IFtzY29wZV07XHJcbiAgICB9XHJcbiAgICBsZXQga2V5c1dpdGhTY29wZSA9IFtdO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc3QgayA9IGtleVtpXTtcclxuICAgICAgaWYgKCF0aGlzLmtleUNvbnRhaW5zTnNTZXBhcmF0b3IoaywgbnNTZXApKSB7XHJcbiAgICAgICAgLy8gRG8gbm90IHNldCBzY29wZSwgaWYga2V5IGNvbnRhaW5zIGEgbmFtZXNwYWNlXHJcbiAgICAgICAga2V5c1dpdGhTY29wZS5wdXNoKFxyXG4gICAgICAgICAgLi4uc2NvcGUubWFwKChzYykgPT4gdGhpcy5qb2luU3RyaW5ncyhrZXlTZXAsIHNjLCBrKSlcclxuICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICAgIGtleXNXaXRoU2NvcGUucHVzaChrKTtcclxuICAgIH1cclxuICAgIHJldHVybiBrZXlzV2l0aFNjb3BlO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBwcmVwZW5kTmFtZXNwYWNlKFxyXG4gICAga2V5OiBzdHJpbmcgfCBzdHJpbmdbXSxcclxuICAgIG5zOiBzdHJpbmcgfCBzdHJpbmdbXSxcclxuICAgIG5zU2VwYXJhdG9yOiBzdHJpbmcgfCBmYWxzZSB8IHVuZGVmaW5lZFxyXG4gICk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IG5zU2VwID0gbnNTZXBhcmF0b3IgfHwgJyc7XHJcbiAgICBpZiAodHlwZW9mIGtleSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAga2V5ID0gW2tleV07XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIG5zID09PSAnc3RyaW5nJykge1xyXG4gICAgICBucyA9IFtuc107XHJcbiAgICB9XHJcbiAgICBsZXQga2V5c1dpdGhOYW1lc3BhY2UgPSBbXTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IGsgPSBrZXlbaV07XHJcbiAgICAgIGlmICghdGhpcy5rZXlDb250YWluc05zU2VwYXJhdG9yKGssIG5zU2VwKSkge1xyXG4gICAgICAgIC8vIERvIG5vdCBzZXQgbmFtZXNwYWNlLCBpZiBrZXkgY29udGFpbnMgYSBuYW1lc3BhY2VcclxuICAgICAgICBrZXlzV2l0aE5hbWVzcGFjZS5wdXNoKC4uLm5zLm1hcCgobikgPT4gdGhpcy5qb2luU3RyaW5ncyhuc1NlcCwgbiwgaykpKTtcclxuICAgICAgfVxyXG4gICAgICBrZXlzV2l0aE5hbWVzcGFjZS5wdXNoKGspO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGtleXNXaXRoTmFtZXNwYWNlO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBqb2luU3RyaW5ncyhzZXBhcmF0b3I6IHN0cmluZywgLi4uc3RyOiBzdHJpbmdbXSkge1xyXG4gICAgcmV0dXJuIFsuLi5zdHJdLmpvaW4oc2VwYXJhdG9yKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUga2V5Q29udGFpbnNOc1NlcGFyYXRvcihrZXk6IHN0cmluZywgbnNTZXBhcmF0b3I6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIGtleS5pbmRleE9mKG5zU2VwYXJhdG9yKSAhPT0gLTE7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHByZXBhcmVPcHRpb25zKG9wdGlvbnM/OiBQaXBlT3B0aW9ucykge1xyXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICBpZiAob3B0aW9ucy5jb250ZXh0ICE9IG51bGwpIG9wdGlvbnMuY29udGV4dCA9IG9wdGlvbnMuY29udGV4dC50b1N0cmluZygpO1xyXG4gICAgcmV0dXJuIG9wdGlvbnM7XHJcbiAgfVxyXG59XHJcbiJdfQ==